<!DOCTYPE html>
<html lang="<%= request.path.eql?('/start/joomla_english') ? 'en' : 'de' %>">
  <head>
    <title><%= page_title %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= favicon_link_tag %>
    <%= favicon_link_tag 'apple-touch-icon.png', :rel => 'apple-touch-icon', :type => "image/png" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>
  <body>
    <span id="side">
      <div id="logo"><a href="/<%= "#{I18n.locale}" %>"><%= image_tag("quote_service_32.png", size: "32x32", class: "logo", alt: t(".logo_alt"), title: "www.zitat-service.de") %></a></div>
      <div id="locale">
        <span id="current-language" class="language-selector"><%= raw(string_for_locale(I18n.locale, true)) %> ▾ </span>
          <div id="language-dropdown" class="hidden">
            <% [:de, :en, :es, :ja, :uk].each do |locale| %>
              <%# e.g. 🇺🇦 UK – українська %>
              <%= raw("<div class='language-option' data-locale='#{locale}'>#{string_for_locale(locale)}</div>") %>
            <% end %>
          </div>
      </div>
      <% if current_user %>
        <p>
          <%= link_to(raw("#{image_tag("user_orange.png", alt: t("g.user"), title: t(".logged_in"))} ") +
                      truncate(h(current_user.login), length: 7), edit_user_path(locale: I18n.locale, id: current_user.id)) %>
          <%= raw("#{image_tag("award_star_bronze_1.png", alt: t(".award_alt"), title: t(".admin"))}") if current_user.admin %>
        </p>
      <% end %>
      <div id="user_nav">
        <p><%= current_user ? link_to('Logout', logout_path(locale: I18n.locale)) : link_to('Login', login_path(locale: I18n.locale)) %></p>
      </div>
      <p><%= link_to t("g.quotes", count: 0), locale: I18n.locale, controller: "quotations" %> <%= link_to("+", controller: "quotations", action: "list_no_public") if has_non_public(Quotation) %></p>
      <p id="letter">
        <%= link_to t("g.categories", count: 0), locale: I18n.locale, controller: "categories" %> <%= link_to("+", controller: "categories", action: "list_no_public") if has_non_public(Category) %>
        <div class="flex-center"><%= raw category_links I18n.locale %></div>
      </p>
      <p id="letter">
        <%= link_to t("g.authors", count: 0), controller: "authors" %> <%= link_to("+", controller: "authors", action: "list_no_public") if has_non_public(Author) %>
        <div class="flex-center"><%= raw author_links I18n.locale %></div>
      </p>
      <p><%= link_to t("g.help"),   locale: I18n.locale, controller: :static_pages, action: :help    %></p>
      <p><%= link_to t(".to_use"),  locale: I18n.locale, controller: :static_pages, action: :use     %></p>
      <p><%= link_to t(".project"), locale: I18n.locale, controller: :static_pages, action: :project %></p>
      <p><%= link_to t(".contact"), locale: I18n.locale, controller: :static_pages, action: :contact %></p>
    </span>
    <% if flash[:error] -%>
      <div id="error"><%= image_tag("exclamation.png", alt: t(".exclamation_alt"), title: t(".exclamation")) %> <%= flash[:error] %></div>
    <% elsif flash[:notice] -%>
      <div id="notice"><%= image_tag("flag_green.png", alt: t(".green_flag_alt"), title: t(".green_flag")) %> <%= flash[:notice] %></div>
    <% end -%>
    <div id="content">
      <%= yield %>
    </div>
  </body>
</html>
